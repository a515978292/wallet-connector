# ä»£å¸å•ä½è½¬æ¢æŒ‡å—

> ç†è§£ balanceã€formatUnits å’Œ parseUnits

---

## ğŸ“Š balance å¯¹è±¡

```typescript
balance = {
  value: 5900000000000000n, // åŸå§‹å€¼ï¼ˆbigintï¼Œweiï¼‰
  decimals: 18, // ç²¾åº¦
  symbol: "ETH", // ä»£å¸ç¬¦å·
};
```

**ä¸ºä»€ä¹ˆ value è¿™ä¹ˆå¤§ï¼Ÿ** å› ä¸ºåŒºå—é“¾åªèƒ½å­˜æ•´æ•°ï¼Œä¸èƒ½å­˜å°æ•°ï¼

---

## ğŸ¯ æ ¸å¿ƒåŸç†

### åŒºå—é“¾åªå­˜æ•´æ•°

```typescript
// âŒ ä¸èƒ½å­˜å‚¨å°æ•°
balance = 0.0059 ETH

// âœ… å®é™…å­˜å‚¨ï¼ˆæ•´æ•°ï¼‰
balance = 5900000000000000 wei

// æ¢ç®—å…¬å¼
1 ETH = 10^18 wei
0.0059 ETH = 5900000000000000 wei
```

**åŸå› ï¼š** æµ®ç‚¹æ•°æœ‰ç²¾åº¦è¯¯å·®ï¼ŒåŒºå—é“¾éœ€è¦ç»å¯¹ç¡®å®šæ€§ã€‚

---

## ğŸ”§ formatUnits - wei â†’ äººç±»å¯è¯»

**ä½œç”¨ï¼š** å°†åŸå§‹å€¼è½¬æ¢ä¸ºå¯è¯»æ ¼å¼ï¼ˆæ˜¾ç¤ºç”¨ï¼‰

```typescript
import { formatUnits } from "viem";

// åŸºæœ¬ç”¨æ³•
const readable = formatUnits(5900000000000000n, 18);
console.log(readable); // "0.0059"

// å®é™…ä½¿ç”¨
const { data: balance } = useBalance({ address });
const display = parseFloat(
  formatUnits(balance.value, balance.decimals)
).toFixed(4);
// "0.0059 ETH"
```

---

## ğŸ”„ parseUnits - äººç±»å¯è¯» â†’ wei

**ä½œç”¨ï¼š** å°†å¯è¯»å€¼è½¬æ¢ä¸ºåŸå§‹å€¼ï¼ˆå‘é€äº¤æ˜“ç”¨ï¼‰

```typescript
import { parseUnits } from "viem";

// ç”¨æˆ·è¾“å…¥ 0.1 ETH
const weiAmount = parseUnits("0.1", 18);
// â†’ 100000000000000000n

// å‘é€äº¤æ˜“
sendTransaction({
  to: recipientAddress,
  value: weiAmount,
});
```

---

## ğŸ’¡ å®Œæ•´æµç¨‹

```typescript
// ğŸ“Š æ˜¾ç¤ºä½™é¢
const { data: balance } = useBalance({ address });
const display = parseFloat(
  formatUnits(balance.value, balance.decimals)
).toFixed(4);
// "0.0059 ETH"

// ğŸ’¸ å‘é€äº¤æ˜“
const weiAmount = parseUnits(userInput, 18);
await sendTransaction({ to: "0x...", value: weiAmount });
```

---

## ğŸ“Š å¸¸è§ä»£å¸çš„ decimals

| ä»£å¸ | Decimals | æ¢ç®—å…³ç³»              | è¯´æ˜            |
| ---- | -------- | --------------------- | --------------- |
| ETH  | 18       | 1 ETH = 10Â¹â¸ wei      | ä»¥å¤ªåŠä¸»å¸      |
| WETH | 18       | 1 WETH = 10Â¹â¸ wei     | åŒ…è£…çš„ ETH      |
| USDT | 6        | 1 USDT = 10â¶ æœ€å°å•ä½ | Tether USD      |
| USDC | 6        | 1 USDC = 10â¶ æœ€å°å•ä½ | USD Coin        |
| DAI  | 18       | 1 DAI = 10Â¹â¸ æœ€å°å•ä½ | MakerDAO ç¨³å®šå¸ |
| WBTC | 8        | 1 WBTC = 10â¸ satoshi  | åŒ…è£…çš„ BTC      |

**æ³¨æ„ï¼š** ä¸åŒä»£å¸çš„ decimals å¯èƒ½ä¸åŒï¼Œä¸€å®šè¦ç”¨æ­£ç¡®çš„ decimals å€¼ï¼

---

## ğŸ› ï¸ å®ç”¨å·¥å…·

```typescript
// æ ¼å¼åŒ–ä½™é¢
function formatBalance(
  value: bigint,
  decimals: number,
  symbol: string
): string {
  return `${parseFloat(formatUnits(value, decimals)).toFixed(4)} ${symbol}`;
}

// å®‰å…¨è½¬æ¢
function safeParseUnits(input: string, decimals: number): bigint | null {
  try {
    return !input || isNaN(Number(input)) ? null : parseUnits(input, decimals);
  } catch {
    return null;
  }
}
```

---

## âš ï¸ å¸¸è§é”™è¯¯

```typescript
// âŒ ç›´æ¥ä½¿ç”¨ value
<p>{balance.value} ETH</p>  // æ˜¾ç¤ºï¼š5900000000000000 ETH

// âœ… ä½¿ç”¨ formatUnits
<p>{formatUnits(balance.value, balance.decimals)} ETH</p>  // 0.0059 ETH

// âŒ é”™è¯¯çš„ decimals
formatUnits(usdtBalance, 18);  // USDT æ˜¯ 6 ä½

// âœ… æ­£ç¡®çš„ decimals
formatUnits(usdtBalance, 6);

// âŒ å­—ç¬¦ä¸²æ‹¼æ¥
formatUnits(balance.value, 18) + 10;  // "0.005910"

// âœ… æ•°å­—è®¡ç®—
parseFloat(formatUnits(balance.value, 18)) + 10;  // 10.0059
```

---

## ğŸ’¡ å¿«é€Ÿè®°å¿†

```typescript
formatUnits(value, decimals)  â†’ wei è½¬ ETHï¼ˆæ˜¾ç¤ºç”¨ï¼‰
parseUnits(input, decimals)   â†’ ETH è½¬ weiï¼ˆäº¤æ˜“ç”¨ï¼‰

// å®Œæ•´ç¤ºä¾‹
const display = parseFloat(formatUnits(balance.value, 18)).toFixed(4);
const amount = parseUnits("0.1", 18);
```

**æ ¸å¿ƒï¼š** åŒºå—é“¾åªå­˜æ•´æ•°ï¼ŒformatUnits ç»™äººçœ‹ï¼ŒparseUnits ç»™é“¾ç”¨ï¼

---

**ä¸‹ä¸€æ­¥ï¼š** æ™ºèƒ½åˆçº¦äº¤äº’ã€ERC20 ä»£å¸æ ‡å‡†
